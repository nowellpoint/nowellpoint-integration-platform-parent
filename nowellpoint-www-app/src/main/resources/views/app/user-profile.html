<#import "template.html" as t>
    <@t.page>
        <script>
            var userProfile = {
                basePath: "${links['user.profile']}",
                id: "${userProfile.id!}",
                firstName: "${userProfile.firstName!}",
                lastName: "${userProfile.lastName!}",
                street: "${(userProfile.address.street)!}",
                city: "${(userProfile.address.city)!}",
                state: "${(userProfile.address.state)!}",
                postalCode: "${(userProfile.address.postalCode)!}",
                countryCode: "${(userProfile.address.countryCode)!}",
                company: "${userProfile.company!}",
                department: "${userProfile.department!}",
                title: "${userProfile.title!}",
                email: "${userProfile.email!}",
                mobilePhone: "${userProfile.mobilePhone!}",
                phone: "${userProfile.phone!}",
                extension: "${userProfile.extension!}",
                fax: "${userProfile.fax!}",
                locale: "${userProfile.locale!}",
                timeZone: "${userProfile.timeZone.ID!}"
            }
            sessionStorage.setItem("userProfile", JSON.stringify(userProfile));
        </script>
        <br>
        <br>
        <div class="container mt-3">
            <div class="row" id="user">
                <div class="col-12">
                    <div class="flextable" style="height: 18px">
                        <div class="flextable-item flextable-primary">
                            <h4><b>${labels["user.profile"]}</b></h4>
                        </div>
                        <div class="flextable-item">
                            <#if ! readonly>
                                <button class="btn btn-link" id="editUserProfile"><span class="icon icon-pencil"></span></button>
                            </#if>
                        </div>
                    </div>
                    <hr>
                    <div id="userView">
                        <div class="row">
                            <div class="col-3">
                                <b>${labels["name"]}</b>
                            </div>
                            <div class="col-9">
                                ${userProfile.name!}
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-3">
                                <b>${labels["email"]}</b>
                            </div>
                            <div class="col-9">
                                ${userProfile.email!}
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-3">
                                <b>${labels["title"]}</b>
                            </div>
                            <div class="col-9">
                                ${userProfile.title!}
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-3">
                                <b>${labels["phone"]}</b>
                            </div>
                            <div class="col-9">
                                ${userProfile.phone!}
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-3">
                                <b>${labels["locale.key"]}</b>
                            </div>
                            <div class="col-9">
                                ${locales[userProfile.locale]!}
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-3">
                                <b>${labels["timezone.key"]}</b>
                            </div>
                            <div class="col-9">
                                ${userProfile.timeZone.ID!}
                            </div>
                        </div>
                        <hr>
                    </div>
                    <div id="userProfileEdit" class="hidden">
                        <form class="form-vertical" name="profile-details" id="profile-details" role="form" method="post" action="${links['user.profile']}/${userProfile.id}">
                            <div class="row form-group">
                                <div class="col-3">
                                    <b><label class="control-label" for="firstName">${labels["first.name"]}</label></b>
                                </div>
                                <div class="col-4">
                                    <input type="text" name="firstName" id="firstName" class="form-control" value="${userProfile.firstName!}" autofocus>
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-3">
                                    <b><label class="control-label" for="lastName">${labels["last.name"]}</label></b>
                                </div>
                                <div class="col-4">
                                    <input type="text" name="lastName" id="lastName" class="form-control" value="${userProfile.lastName!}" required>
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-3">
                                    <b><label class="control-label" for="email">${labels["email"]}</label></b>
                                </div>
                                <div class="col-4">
                                    <input type="text" name="email" id="email" class="form-control" value="${userProfile.email!}" required>
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-3">
                                    <b><label class="control-label" for="phone">${labels["phone"]}</label></b>
                                </div>
                                <div class="col-4">
                                    <input type="text" name="phone" id="phone" class="form-control" value="${userProfile.phone!}">
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-3">
                                    <b><label class="control-label" for="title">${labels["title"]}</label></b>
                                </div>
                                <div class="col-4">
                                    <input type="text" name="title" id="title" class="form-control" value="${userProfile.title!}">
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-3">
                                    <b><label class="control-label" for="locale">${labels["locale.key"]}</label></b>
                                </div>
                                <div class="col-4">
                                    <select id="locale" name="locale" class="form-control" required>
                                        <#list locales?keys as key>
                                            <#if userProfile.locale==key>
                                                <option value="${key}" selected="selected">${locales[key]}</option>
                                            </#if>
                                            <#if userProfile.locale !=key>
                                                <option value="${key}">${locales[key]}</option>
                                            </#if>
                                        </#list>
                                    </select>
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-3">
                                    <b><label class="control-label" for="timeZone">${labels["timezone.key"]}</label></b>
                                </div>
                                <div class="col-4">
                                    <select id="timeZone" name="timeZone" class="form-control" required>
                                        <#list timeZones as timeZone>
                                            <#if userProfile.timeZone.ID==timeZone>
                                                <option value="${timeZone}" selected="selected">${timeZone}</option>
                                            </#if>
                                            <#if userProfile.timeZone.ID !=timeZone>
                                                <option value="${timeZone}">${timeZone}</option>
                                            </#if>
                                        </#list>
                                    </select>
                                </div>
                            </div>
                        </form>
                        <div class="row">
                            <div class="col-3"></div>
                            <div class="col-4">
                                <button class="btn btn-success" id="saveUserProfile">${labels["save"]}</button>
                                <button class="btn btn-link" id="cancelUserProfile">${labels["cancel"]}</button>
                            </div>
                            <hr>
                        </div>
                    </div>
                </div>
            </div>
            <br>
            <br>
            <div class="row" id="address">
                <div class="col-12">
                    <div class="flextable" style="height: 18px">
                        <div class="flextable-item flextable-primary">
                            <h4><b>${labels["address"]}</b></h4>
                        </div>
                        <div class="flextable-item">
                            <button class="btn btn-link" id="editAddress"><span class="icon icon-pencil"></span></button>
                        </div>
                    </div>
                    <hr>
                    <div id="addressView">
                        <div class="row">
                            <div class="col-3">
                                <b>${labels["street"]}</b>
                            </div>
                            <div class="col-9">
                                ${(userProfile.address.street)!}
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-3">
                                <b>${labels["city"]}</b>
                            </div>
                            <div class="col-9">
                                ${(userProfile.address.city)!}
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-3">
                                <b>${labels["state"]}</b>
                            </div>
                            <div class="col-9">
                                ${(userProfile.address.state)!}
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-3">
                                <b>${labels["postal.code"]}</b>
                            </div>
                            <div class="col-9">
                                ${(userProfile.address.postalCode)!}
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-3">
                                <b>${labels["country"]}</b>
                            </div>
                            <div class="col-9">
                                ${(userProfile.address.country)!}
                            </div>
                        </div>
                        <hr>
                    </div>
                    <div id="addressEdit" class="hidden">
                        <form class="form-vertical" name="profile-address" id="profile-address" role="form" method="post">
                            <div class="row form-group">
                                <div class="col-3">
                                    <b><label class="control-label" for="street">${labels["street"]}</label></b>
                                </div>
                                <div class="col-4">
                                    <input type="text" class="form-control" name="street" id="street" value="${(userProfile.address.street)!}" />
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-3">
                                    <b><label class="control-label" for="city">${labels["city"]}</label></b>
                                </div>
                                <div class="col-4">
                                    <input type="text" class="form-control" name="city" id="city" value="${(userProfile.address.city)!}" />
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-3">
                                    <b><label class="control-label" for="state">${labels["state"]}</label></b>
                                </div>
                                <div class="col-4">
                                    <input type="text" class="form-control" name="state" id="state" value="${(userProfile.address.state)!}" />
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-3">
                                    <b><label class="control-label" for="postalCode">${labels["postal.code"]}</label></b>
                                </div>
                                <div class="col-4">
                                    <input type="text" class="form-control" name="postalCode" id="postalCode" value="${(userProfile.address.postalCode)!}" />
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-3">
                                    <b><label class="control-label" for="countryCode">${labels["country"]}</label></b>
                                </div>
                                <div class="col-4">
                                    <select id="countryCode" name="countryCode" class="form-control" required>
                                        <#list countryList as country>
                                            <#if country.iso2Code==userProfile.address.countryCode>
                                                <option value="${country.iso2Code}" selected="selected">${country.name}</option>
                                            </#if>
                                            <#if country.iso2Code !=userProfile.address.countryCode>
                                                <option value="${country.iso2Code}">${country.name}</option>
                                            </#if>
                                        </#list>
                                    </select>
                                </div>
                            </div>
                        </form>
                        <div class="row">
                            <div class="col-3"></div>
                            <div class="col-4">
                                <button class="btn btn-success" id="saveAddress">${labels["save"]}</button>
                                <button class="btn btn-link" id="cancelAddress">${labels["cancel"]}</button>
                            </div>
                            <hr>
                        </div>
                    </div>
                </div>
            </div>
            <div id="overlay"></div>

            <script src="/js/user-profile.js"></script>

    </@t.page>